# 要件定義書

**アプリケーション名:** Remindrop

> **📝 このドキュメントの更新タイミング**
> - 機能の追加・削除・変更があったとき
> - 非機能要件（パフォーマンス、セキュリティなど）が変わったとき
> - 制約事項や前提条件が変わったとき

## 1. プロジェクト概要

### 1.1 背景・課題
現在、Raindrop.ioなどのブックマークサービスを使って日々気になった技術ブログやTwitterのツイートをクリップしているが、クリップしているだけでほとんど後から見直すことができていない。

### 1.2 解決したいこと
一日の終わりにその日にクリップした記事をサマリーで簡単に見直せるようにしたい。

### 1.3 提供価値
- クリップした記事を自動で要約することで、短時間で内容を把握できる
- 自動タグ付けで記事を整理・分類
- デイリーサマリーメールで振り返りを習慣化
- 全文検索で過去の記事を簡単に発見

### 1.4 想定ユーザー
- **初期**: 開発者本人のみ
- **将来**: 他のユーザーにも公開予定(完全オープン)

---

## 2. 機能要件

### 2.1 MVP機能(Phase 1)

#### 2.1.1 ブックマーク管理機能

**ブックマークの作成**
- インターネットでアクセスできるあらゆるリソース(URLがあるリソース)を保存可能
- ブラウザ拡張機能からワンクリックでクリップ
- Webアプリからもクリップ可能
- クリップ時の動作:
  - 確認ダイアログなし(即座にクリップ)
  - トースト通知で完了を表示
  - 間違えてクリップした場合の削除機能あり

**自動処理**
- クリップ時に以下の情報を自動取得・生成:
  - URL、タイトル
  - ページの本文テキスト(HTMLではなくプレーンテキスト)
  - OGP画像、OGP説明文
  - AI生成要約(デフォルト3行、設定で調整可能)
  - AI生成タグ(自動分類)

**ブックマークの削除**
- 個別削除機能

#### 2.1.2 閲覧・検索機能

**一覧表示**
- ブックマーク一覧画面
- 各ブックマークの表示内容:
  - タイトル
  - 要約(3行)
  - タグ
  - 作成日時
  - OGP画像(サムネイル)
- ページネーション対応

**検索機能**
- 全文検索(タイトル、要約、タグ、本文テキストを対象)
- 検索ボックスからのリアルタイム検索

**フィルタリング機能**
- タグでフィルタ
- 日付範囲でフィルタ(開始日〜終了日)
- 複数フィルタの組み合わせ可能

**詳細表示**
- ブックマーク詳細画面
- 表示内容:
  - タイトル
  - URL(リンク)
  - 本文テキスト
  - 要約
  - タグ一覧
  - 作成日時、更新日時

#### 2.1.3 タグ管理機能

**自動タグ付け**
- ブックマーク作成時にAIが自動でタグを生成
- 既存のタグがあれば再利用、なければ新規作成

**タグ一覧**
- 全タグの一覧表示
- 各タグの使用回数を表示

**タグ削除**
- タグの削除機能
- タグを削除してもブックマークは残る

#### 2.1.4 デイリーサマリー機能

**自動サマリー生成**
- 毎日指定時刻(デフォルト21:00)に実行
- その日にクリップしたブックマークを集計

**メール通知**
- サマリーをメールで送信
- メール内容:
  - 日付
  - ブックマーク件数
  - 各ブックマークのタイトル、要約、URL

**送信制御**
- その日のブックマークが0件の場合は送信しない

#### 2.1.5 ユーザー管理・認証機能

**アカウント登録**
- メールアドレス/パスワードでの登録
- OAuth認証(Google、GitHub)
- 完全オープン(誰でも登録可能)

**ログイン**
- メールアドレス/パスワード
- OAuth(Google、GitHub)

**ログアウト**
- セッションの削除

**セッション管理**
- セッションベースの認証
- 自動ログアウト(セッション期限切れ)

#### 2.1.6 ユーザー設定機能

**設定項目**
- デイリーサマリー送信時刻(デフォルト: 21:00)
- 要約の長さ(行数、デフォルト: 3行)
- 通知先メールアドレス(未設定の場合はアカウントのメールアドレス)
- タイムゾーン(デフォルト: Asia/Tokyo)

**設定変更**
- 設定画面から変更可能
- 変更は即座に反映

### 2.2 Phase 2以降の機能(後回し)

以下の機能は当面実装しない:

**クリップ機能拡張**
- テキスト選択クリップ
- ファイルアップロード(PDF、画像など)
- Raindrop.ioからの移行機能

**要約機能拡張**
- 手動での要約再生成ボタン
- 過去クリップの一括再要約
- 要約の音声読み上げ(ポッドキャスト形式)

**コンテンツ保存拡張**
- HTMLスナップショット保存(完全なページ保存)
- 画像・動画の保存

**共有機能**
- 公開コレクション
- ブックマークの共有

**通知拡張**
- Slack通知
- Discord通知
- プッシュ通知

**モバイル**
- iOSアプリ
- Androidアプリ
- (iOSショートカット経由でのAPI利用は可能)

---

## 3. 非機能要件

### 3.1 パフォーマンス要件

**応答時間**
- ブックマーク作成API: 500ms以内にレスポンス
- 要約・タグ生成: バックグラウンド処理(10-30秒)
- ブックマーク一覧表示: 初期表示1秒以内
- 全文検索: 2秒以内

**スループット**
- 同時ユーザー数: 初期は1名、将来的に100名程度を想定
- 1ユーザーあたりの1日のクリップ数: 50件程度を想定

### 3.2 セキュリティ要件

**通信**
- 全ての通信をHTTPS化
- CloudFront + ACMでSSL/TLS証明書管理

**認証・認可**
- 全てのAPIエンドポイントで認証必須
- セッションベース認証
- パスワードはハッシュ化して保存

**データ保護**
- ブックマークデータはユーザーごとに分離
- 他ユーザーのデータへのアクセス不可
- S3バケットはOAC(Origin Access Control)で非公開

**機密情報管理**
- APIキー、データベース接続情報は環境変数で管理
- AWS Secrets Managerの利用も検討

### 3.3 可用性要件

**稼働率**
- 目標稼働率: 99%(初期段階)
- ダウンタイム: 月1時間程度は許容

**バックアップ**
- RDSの自動バックアップ(7日間保持)
- 毎日1回自動バックアップ

**障害対応**
- Lambda: 自動リトライ(最大3回)
- EventBridge: 失敗時の自動リトライ
- CloudWatch Alarmでエラー監視

### 3.4 拡張性要件

**スケーラビリティ**
- Lambdaで自動スケール
- RDSは必要に応じて手動スケールアップ

**データ量**
- 1ユーザーあたり10,000件のブックマークを想定
- 1ブックマークあたり平均5KB(本文テキスト)
- 総データ量: 1ユーザーあたり50MB程度

### 3.5 保守性要件

**コード品質**
- TypeScriptで型安全なコード
- ESLintでコード品質チェック
- Prettierでコードフォーマット統一

**インフラ管理**
- AWS CDKでInfrastructure as Code
- バージョン管理: Git(GitHub)

**ログ・モニタリング**
- CloudWatch Logsでアプリケーションログ管理
- CloudWatch Metricsでパフォーマンス監視
- エラー発生時のアラート通知

**ドキュメント**
- README.mdでセットアップ手順を記載
- APIドキュメントをSwagger/OpenAPIで管理

### 3.6 コスト要件

**目標コスト**
- 月額$20以下
- 初期構築コスト: $0(無料枠活用)

**コスト見積もり(個人利用時)**
- RDS PostgreSQL (db.t4g.micro): $12-15/月
- Lambda: ほぼ$0(無料枠内)
- S3 + CloudFront: $0-3/月(無料枠+α)
- Anthropic API (Claude Haiku): $2-5/月
- SES: ほぼ$0(無料枠内)
- **合計: 約$14-23/月**

**コスト削減策**
- Claude Haikuを使用(Sonnetより安価)
- RDSは最小インスタンス
- Lambdaは無料枠内に収める
- CloudFront無料枠を最大活用

---

## 4. 制約事項

### 4.1 技術的制約

**クリップ対象**
- URLがあるリソースのみ
- JavaScriptで動的に生成されるコンテンツは取得できない場合がある
- ログインが必要なページは取得不可

**ブラウザ拡張**
- Chrome、Firefoxのみ対応(初期)
- Safariは後回し

**LLM API**
- Anthropic APIに依存
- APIの利用制限やレート制限に準拠
- API障害時は要約・タグ生成が失敗

### 4.2 運用上の制約

**開発リソース**
- 開発者1名
- 週10-20時間程度の作業時間

**初期ユーザー**
- 自分自身のみ

**サポート**
- 初期段階ではサポートなし
- GitHubのIssueでのみ対応

---

## 5. 想定されるユースケース

### 5.1 日常のクリップフロー

**朝**
1. ニュースサイトで気になる記事を発見
2. ブラウザ拡張のアイコンをクリック
3. 自動で保存・要約される

**昼**
1. Twitterで興味深いスレッドを発見
2. ブラウザ拡張でクリップ

**夕方**
1. 技術ブログを複数クリップ

**夜(21:00)**
1. デイリーサマリーメールが届く
2. メールで今日のクリップを振り返る
3. 気になる記事はリンクから詳細を確認

### 5.2 検索・再発見フロー

**ケース1: キーワード検索**
1. 「React hooks」で検索
2. 過去にクリップした関連記事が一覧表示
3. 要約を見て目的の記事を発見

**ケース2: タグ絞り込み**
1. 「TypeScript」タグでフィルタ
2. TypeScript関連の記事のみ表示
3. 日付でソートして最新記事を確認

**ケース3: 期間指定**
1. 「先月クリップした記事」を確認
2. 日付範囲を指定して検索
3. 時系列で振り返り

---

## 6. 成功基準

### 6.1 定量的指標

**開発期間**
- MVP完成: 7週間以内

**コスト**
- 月額運用コスト: $20以下

**パフォーマンス**
- ブックマーク作成レスポンス: 95%が500ms以内
- ページ初期表示: 95%が1秒以内

### 6.2 定性的指標

**使いやすさ**
- 自分が毎日使い続けられる
- クリップが習慣化する

**振り返りの実現**
- デイリーサマリーメールを毎日確認する
- 月1回は過去のクリップを検索して活用する

**学習効果**
- AWS、TypeScript、AI統合の知識が身につく
- 実運用経験が得られる

---

## 7. 受け入れ基準

### 7.1 MVP完成の定義

以下の全ての機能が動作すること:

**ブックマーク管理**
- [ ] ブラウザ拡張からクリップできる
- [ ] Webアプリからクリップできる
- [ ] 要約が自動生成される
- [ ] タグが自動生成される
- [ ] ブックマークを削除できる

**閲覧・検索**
- [ ] ブックマーク一覧が表示される
- [ ] 全文検索ができる
- [ ] タグでフィルタできる
- [ ] 日付範囲でフィルタできる
- [ ] ページネーションが動作する

**デイリーサマリー**
- [ ] 毎日21:00にメールが送信される
- [ ] メール内容が正しい
- [ ] ブックマークが0件の日は送信されない

**認証**
- [ ] メール/パスワードでログインできる
- [ ] Googleでログインできる
- [ ] GitHubでログインできる
- [ ] ログアウトできる

**設定**
- [ ] デイリーサマリー時刻を変更できる
- [ ] 要約の長さを変更できる

### 7.2 品質基準

**動作確認**
- [ ] Chrome、Firefoxでブラウザ拡張が動作
- [ ] モバイルブラウザで表示確認(レスポンシブ)
- [ ] 主要な操作でエラーが発生しない

**パフォーマンス**
- [ ] ブックマーク作成が500ms以内
- [ ] ページ表示が1秒以内

**セキュリティ**
- [ ] 他ユーザーのデータにアクセスできない
- [ ] HTTPS通信
- [ ] 認証なしでAPIにアクセスできない

---

作成日: 2024-12-13
バージョン: 1.0
